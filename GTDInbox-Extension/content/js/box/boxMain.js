var boxMain=giMainPageUIPlugin.extend({_loaded:false,_serverUI:null,_baseUiQueue:null,constructor:function(){this._baseUiQueue=[]},load:function(accountData,pageBase,classPrefix,serverAccount,pageId){giLogger.log("st","boxMain.load",pageId);this.base(accountData,pageBase,"box",serverAccount,pageId);this.gmail.page.addEventListener(glPageWrapper.UI_READY,this._baseUIReady,this)},unload:function(){this.base()},_baseUIReady:function(evt){try{this.gmail.page.addCSS(giUrl.getURL("skin/box/c/main.css"));
var box=this.getUIObject("box");this._loaded=true;this.dispatchEvent({name:boxMain.LOADED});if(this.prefs.getPref("force_above_chat")){var doc=this.gmail.canvasDocument;var elChatRoot=doc.evaluate(".//div[contains(@class,'ps')]",this.gmail.getUIObject("navBar").navBar,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;elChatRoot.parentNode.insertBefore(box.el,elChatRoot)}for(var i=0;i<this._baseUiQueue.length;i++){var q=this._baseUiQueue[i];this[q.func].apply(this,q.args)}}catch(e){giLogger.warn(e,
"boxMain._baseUIReady",null,this.pageId)}},isLoaded:function(){return this._loaded},loadServerUI:function(serverAccount,loadSecondary){if(this._loaded){if(!serverAccount)serverAccount=this.serverAccount;this.getUIObject("about").loadServerUI(serverAccount,loadSecondary)}else this._baseUiQueue.push({func:"loadServerUI",args:arguments})}},{LOADED:"box_loaded"});boxMain.implement(giEventDispatcher);giPluginManager.registerPlugin({id:"box",version:"1.0a4",main:"boxMain",defaults:"content/js/box/default-prefs.json"});
