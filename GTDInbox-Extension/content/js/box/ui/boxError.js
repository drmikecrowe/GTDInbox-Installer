var boxError=boxSection.extend({_elNotice:null,_errorFunc:null,_errorCount:0,_isLoaded:false,connect:function(main){this.id="boxerror";this.base(main);var doc=this._main.gmail.canvasDocument;var el=doc.createElement("DIV");el.id="gtdi-box-error";this._addRow("error",el,null);if(this._main.prefs.getGlobal("do_not_show_error_monitor"))el.style.display="none";else{var elHide=doc.createElement("DIV");elHide.innerHTML="x";elHide.id="gtdi-box-error-hide";el.appendChild(elHide);var elTitle=doc.createElement("DIV");
elTitle.id="gtdi-box-error-title";elTitle.innerHTML=giI18N.getString("Box.error.title");el.appendChild(elTitle);this._elNotice=doc.createElement("DIV");this._elNotice.id="gtdi-box-error-notice";el.appendChild(this._elNotice);var elButtonContainer=doc.createElement("DIV");elButtonContainer.id="gtdi-box-error-reportcontainer";elButtonContainer.innerHTML="<button id='gtdi-box-error-report'>"+giI18N.getString("Box.error.report")+"</button>";el.appendChild(elButtonContainer);this._eventsContainer.observe(this.el,
"click",this._click,false);var me=this;this._errorFunc=function(evt){me._errorReportCreated(evt)};giLogger.addEventListener(giLogger.ERROR_REPORT_CREATED,this._errorFunc);this.refresh()}this._isLoaded=true},disconnect:function(){giLogger.removeEventListener(giLogger.ERROR_REPORT_CREATED,this._errorFunc);this.base()},refresh:function(){var errorCount=giLogger.getErrorReportCount(this._main.pageId,true);if(errorCount==0){this._elNotice.innerHTML="";this.el.style.display="none"}else{this.el.style.display=
"";if(errorCount==1)this._elNotice.innerHTML=giI18N.getString("Box.error.notice.singular");else this._elNotice.innerHTML=giI18N.getString("Box.error.notice").replace("%1",errorCount)}if(errorCount>this._errorCount);this._errorCount=errorCount},_errorReportCreated:function(evt){this.refresh()},_click:function(evt){var el=evt.target;try{switch(el.id){case "gtdi-box-error-report":this._main.getUIObject("errorReporter");break;case "gtdi-box-error-hide":this.el.style.display="none";break}}catch(e){giLogger.warn(e,
"boxError._click",null,this._main?this._main.pageId:giLogger.UNKNOWN_PAGE_ID)}},isLoaded:function(){return this._isLoaded}});
