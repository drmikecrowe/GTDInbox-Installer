var boxBox=giUIObject.extend({el:null,elHeader:null,_elHeaderBlogNew:null,_navBox:null,_sections:null,_isLoaded:false,_sectionQueue:null,connect:function(main){giLogger.log("st","boxBox.connect",main?main.pageId:giLogger.UNKNOWN_PAGE_ID);this.base(main);this._sections=[];this._sectionQueue=[];this._navBox=this._main.gmail.getUIObject("navModule");this.el=this._navBox.root;this.el.className+=" gtdi gtdi-box";this.elHeader=this._navBox.title;this.elHeader.innerHTML="<img src='"+giUrl.getURL("skin/box/i/gtdi-logo-mini.png")+
"'/>";var offlineSection=this._main.getUIObject("offlineWarning");this.addSection(offlineSection);var aboutSection=this._main.getUIObject("about");this.addSection(aboutSection);var errorSection=this._main.getUIObject("error");this.addSection(errorSection);aboutSection.boxNews.addEventListener(boxNews.BLOG_UPDATED,this._blogUpdated,this);this._elHeaderBlogNew=this.el.ownerDocument.createElement("IMG");this._elHeaderBlogNew.className="gtdi-news-new";this._elHeaderBlogNew.style.display="none";this._elHeaderBlogNew.src=
giUrl.getURL("skin/box/newitem.png");this.elHeader.appendChild(this._elHeaderBlogNew);this._isLoaded=true;for(var i=0;i<this._sectionQueue.length;i++)this.addSection(this._sectionQueue[i][0],this._sectionQueue[i][1]);this._sectionQueue.length=0},disconnect:function(){this.el.parentNode.removeChild(this.el);this.el=null;this.elHeader=null;for(var i=0;i<this._sections.length;i++)this._sections[i].disconnect();this._sections.length=0;this._navBox.disconnect();this._navBox=null;this.base()},addSection:function(section,
insertBeforeLinks){if(!this._isLoaded){this._sectionQueue.push([section,insertBeforeLinks]);return}if(insertBeforeLinks&&this._sections.length>0&&this._sections[this._sections.length-2]instanceof boxAbout){this._sections.splice(this._sections.length-2,0,section);this._navBox.content.insertBefore(section.el,this._sections[this._sections.length-2].el)}else{this._sections.push(section);this._navBox.content.appendChild(section.el)}},removeSection:function(section){for(var i=0;i<this._sections.length;i++)if(this._sections[i]==
section){this._sections.splice(i,1);section.disconnect()}},_blogUpdated:function(evt){this._elHeaderBlogNew.style.display=evt.newItems>0?"":"none";this._elHeaderBlogNew.title=giI18N.getString("News.blog.new.title").replace("%1",evt.newItems)},isCacheable:function(){return true}});
