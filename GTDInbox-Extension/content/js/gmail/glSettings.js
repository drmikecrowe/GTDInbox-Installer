var glSettings=giBase.extend({_gmail:null,data:null,_isLoaded:false,_isLoading:false,_lastView:null,constructor:function(gmail){this._gmail=gmail;this._gmail.page.addEventListener(glPageWrapper.VIEW_CHANGED,this._viewChanged,this)},load:function(){giLogger.log("st","glSettings.load",this._gmail.pageId);if(this._isLoading)return;this._isLoaded=false;this._isLoading=true;this.data={};var request=glRequest.createSettingsRequest(this._gmail);request.addEventListener(glRequest.COMPLETED,this._loadComplete,
this);request.run()},_loadComplete:function(evt){giLogger.log("st","glSettings._loadComplete",this._gmail.pageId);var request=evt.target;this.data=request.data.getSettingsData();this._isLoading=false;this._isLoaded=true;this.dispatchEvent({name:glSettings.LOADED})},isLoaded:function(){return this._isLoaded},_viewChanged:function(evt){if(evt.view!="s"&&this._lastView=="s")if(!this._isLoading){this._isLoaded=false;this.data=null}this._lastView=evt.view}},{LOADED:"loaded"});glSettings.implement(giEventDispatcher);
