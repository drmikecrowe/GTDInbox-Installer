var glSettingsView=glUIView.extend({_elRoot:null,_eventsContainer:null,connect:function(main){giLogger.log("st","glSettingsView.connect",main.pageId);this.base(main);this._eventsContainer=new giEventsContainer(this);var doc=this._gmail.canvasDocument;this._elRoot=this._gmail.page.getViewRoot();var elTabs=doc.evaluate(".//div[contains(@class, 'nH f2')]/div[@class='nH fY']",this._elRoot,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;if(!elTabs)giLogger.error("Could not find tabs header in Settings view",
"glSettingsView.connect",this._gmail?this._gmail.pageId:giLogger.UNKNOWN_PAGE_ID);this._eventsContainer.observe(elTabs,"click",this._clickTabs,false)},disconnect:function(){this._eventsContainer.reset();this._eventsContainer=null;this.base()},getTab:function(name){var doc=this._gmail.canvasDocument;if(!name){var elTab=doc.evaluate(".//div[@class='fZ']/a",this._elRoot,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;if(elTab){var m=elTab.href.match(/settings\/(\w+)$/i);if(m)name=m[1]}else giLogger.error("Could not find current tab when no name.",
"glSettingsView.getTab",this._gmail?this._gmail.pageId:giLogger.UNKNOWN_PAGE_ID)}if(!name)giLogger.error("Could not find name of Settings tab","glSettingsView.getTab",this._gmail?this._gmail.pageId:giLogger.UNKNOWN_PAGE_ID);var tabData={tabName:name};tabData.elLink=doc.evaluate(".//div[@class='fZ']/a[contains(@href, '#settings/"+name+"')]",this._elRoot,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;if(!tabData.elLink)giLogger.error("Could not find tab link.","glSettingsView.getTab",
this._gmail?this._gmail.pageId:giLogger.UNKNOWN_PAGE_ID);tabData.elTab=tabData.elLink.parentNode;var el=tabData.elTab;var idx=0;while(el.previousSibling){idx++;el=el.previousSibling}var elContentContainer=tabData.elTab.parentNode.parentNode.childNodes[1];tabData.elContent=elContentContainer.childNodes[idx];return tabData},_clickTabs:function(){try{var evtData=this.getTab();evtData.name=glSettingsView.SELECT_TAB;this.dispatchEvent(evtData)}catch(e){giLogger.warn(e,"glSettingsView._click",null,this._gmail?
this._gmail.pageId:giLogger.UNKNOWN_PAGE_ID)}}},{SELECT_TAB:"select_tab",LABELS_TAB:"labels"});glSettingsView.implement(giEventDispatcher);
