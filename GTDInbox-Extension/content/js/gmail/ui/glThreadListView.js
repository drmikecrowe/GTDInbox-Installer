var glThreadListView=glUIView.extend({_threadListTables:null,connect:function(gmail){giLogger.log("st","glThreadListView.connect",gmail.pageId);this.base(gmail);var doc=this._gmail.canvasDocument;var viewRoot=this._gmail.page.getViewRoot();this._threadListTables=[];if(this.hasMultipleInboxes()){giLogger.log("Has multiple inboxes","glThreadListView.connect",gmail.pageId);var result=doc.evaluate(".//div[contains(@class,'nH nn')]",viewRoot,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);var elMainContainer=
result.singleNodeValue;var tlt=new glThreadListTable(this._gmail,elMainContainer,true,this);this._threadListTables.push(tlt);giLogger.log("Added main","glThreadListView.connect",gmail.pageId);var results=doc.evaluate(".//DIV[@class='nH nK']",viewRoot,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var i=0;i<results.snapshotLength;i++){giLogger.log("Adding multiple inbox","glThreadListView.connect",gmail.pageId);var tlt=new glThreadListTable(this._gmail,results.snapshotItem(i),false,this,i);
this._threadListTables.push(tlt)}}else{giLogger.log("No multiple inbox - adding main","glThreadListView.connect",gmail.pageId);this._threadListTables.push(new glThreadListTable(this._gmail,viewRoot,true,this))}},disconnect:function(){for(var i=0;i<this._threadListTables.length;i++)this._threadListTables[i].unload();this.base()},getThreadListTables:function(){return this._threadListTables},getThreadListTableByEl:function(el){var tlts=this._threadListTables;while(el.parentNode){for(var i=0;i<tlts.length;i++)if(el==
tlts[i].el)return tlts[i];el=el.parentNode}},getActionsHeader:function(){for(var i=0;i<this._threadListTables.length;i++)if(this._threadListTables[i].isMain)return this._threadListTables[i].actionsHeader},hasMultipleInboxes:function(){var doc=this._gmail.canvasDocument;var viewRoot=this._gmail.page.getViewRoot();var result=doc.evaluate(".//div[contains(@class,'nH nK')]",viewRoot,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);if(result.singleNodeValue)return true;else{var count=doc.evaluate(".//DIV[@class='nH Cp']",
viewRoot,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength;if(count>1){giLogger.logConcern("First test for multiple inbox failed and second succeeded. Not confident of presence of multiple inboxes. Suggests HTML/CSS change.","glThreadListView.hasMultipleInboxes",this._gmail?this._gmail.pageId:giLogger.UNKNOWN_PAGE_ID);return true}else return false}},uncheckRows:function(){var elTL=this._gmail.page.getViewRoot();var elInputs=elTL.getElementsByTagName("INPUT");for(var i=0;i<elInputs.length;i++)if(elInputs[i].getAttribute("type").toLowerCase()==
"checkbox")if(elInputs[i].checked==true)giUIObject.simulateMouseEvent(elInputs[i],"click")},getDOMRowLabels:function(el){var labels=[];while(el.parentNode&&el.nodeName!="TR")el=el.parentNode;if(el.nodeName=="TR"){var results=el.ownerDocument.evaluate(".//DIV[@class='av']",el,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var i=0;i<results.snapshotLength;i++)labels.push(giUtil.decodeEntities(results.snapshotItem(i).innerHTML))}return labels}});
