var gtdSearchBuilder=giUIObject.extend({el:null,currentItem:null,parent:null,_currentElSpawn:null,_currentChild:null,connect:function(main){giLogger.log("st","gtdSearchBuilder.connect",main?main.pageId:giLogger.UNKNOWN_PAGE_ID);this.base(main);var doc=this._main.gmail.canvasDocument;this.el=doc.createElement("DIV")},disconnect:function(){if(this._currentChild)this._currentChild.disconnect();this._currentChild=null;this.parent=null;this.currentItem=null;this._currentElSpawn=null;this._removeAllListeners();
for(p in this)if(this.hasOwnProperty(p)&&this[p]&&this[p].nodeName)this[p]=null;this.base()},hide:function(all){if(all&&this.parent){var sb=this;while(sb.parent)sb=sb.parent;sb.hide(all)}else{var cc=this._currentChild;if(cc)cc.hide();this.dispatchEvent({name:gtdSearchBuilder.HIDE})}},load:function(parent){if(parent)this.parent=parent;this.currentItem=null;this._currentElSpawn=null;if(this._currentChild)this._currentChild.hide()},_setCurrent:function(item,el){if(this.currentItem!=item){if(this._currentElSpawn)giUIObject.removeClassName(this._currentElSpawn,
"gtdi-active");this.currentItem=item;this._currentElSpawn=el;if(this._currentChild)this._currentChild.hide()}},getChild:function(){return this._currentChild},openChild:function(){if(!this._currentChild){this._currentChild=this._createChild();this._currentChild.load(this);this._currentChild.addEventListener(gtdSearchBuilder.HIDE,this._childRequestedHide,this);this.dispatchEvent({name:gtdSearchBuilder.OPEN_CHILD,elSpawn:this._currentElSpawn,child:this._currentChild});if(this._currentElSpawn)giUIObject.addClassName(this._currentElSpawn,
"gtdi-active")}},_createChild:function(){throw new Error("Override gtdSearchBuilder._createChild");},_childRequestedHide:function(evt){if(this._currentChild)this._currentChild=null},getSearch:function(sc){if(!sc)sc=new glSearchConditions;sc.addCondition(this._getSearchInner());if(this.parent)this.parent.getSearch(sc);return sc},_getSearchInner:function(){return new glSearchConditions}},{HIDE:"gtdSearchBuilder.hide",OPEN_CHILD:"gtdSearchBuilder.open_child"});gtdSearchBuilder.implement(giEventDispatcher);
