var gtdThreadListGroup=giUIObject.extend({id:null,displayName:null,el:null,_elThreads:null,elTitle:null,_threads:null,_threadsHash:null,_groupBy:null,_eventsContainer:null,connect:function(main){giLogger.log("st","gtdThreadListGroup.connect",main?main.pageId:giLogger.UNKNOWN_PAGE_ID);this.base(main);this._eventsContainer=new giEventsContainer(this);this._threads=[];this._threadsHash={};var doc=main.gmail.canvasDocument;this.el=doc.createElement("DIV");this.el.className="gtdi-threadlist-group";elHeader=
doc.createElement("H2");elHeader.className="gtdi-threadlist-group-title";this.el.appendChild(elHeader);this.elTitle=doc.createElement("SPAN");elHeader.appendChild(this.elTitle);this._elThreads=doc.createElement("DIV");this._elThreads.className="gtdi-threadlist-group-threads";this.el.appendChild(this._elThreads)},disconnect:function(){if(this.el&&this.el.parentNode)this.el.parentNode.removeChild(this.el);this.el=null;this._elThreads=null;this.elTitle=null;for(var i=0;i<this._threads.length;i++)this._threads[i].disconnect();
this._threads.length=0;this._threadsHash=null;this._eventsContainer.reset();this._groupBy=null;this._threads=null;this._eventsContainer=null;this.base()},load:function(id,displayName,groupBy){this.id=id;this.displayName=displayName||id;this.elTitle.innerHTML=this.displayName;this._groupBy=groupBy},getNumberThreads:function(){return this._threads.length},getThreadListThread:function(thread){return this._threadsHash[thread.threadId]},getThreads:function(){return this._threads},addThread:function(thread,
lite){if(!this._threadsHash[thread.threadId]){var threadListThread=gtdThreadListThread.create(this._main,thread);this._threads.push(threadListThread);this._threadsHash[thread.threadId]=threadListThread}if(!lite)this.sort(this._threadsHash[thread.threadId])},removeThread:function(thread){if(this._threadsHash[thread.threadId]){var threadListThread=this._threadsHash[thread.threadId];threadListThread.disconnect();var pos=this._threads.indexOf(threadListThread);if(pos>-1)this._threads.splice(pos,1);delete this._threadsHash[thread.threadId]}},
sort:function(thread){if(this._groupBy.sortThreads)this._threads.sort(this._groupBy.sortThreads);if(thread){var pos=this._threads.indexOf(thread);if(pos==this._threads.length-1||pos>=this._elThreads.childNodes.length)this._elThreads.appendChild(thread.el);else if(this._elThreads.childNodes[pos]!=thread.el)this._elThreads.insertBefore(thread.el,this._elThreads.childNodes[pos])}else for(var i=0;i<this._threads.length;i++)this._elThreads.appendChild(this._threads[i].el)},_click:function(event){try{var el=
event.target}catch(e){giLogger.warn(e,"gtdThreadListGroup._click",null,this._main?this._main.pageId:giLogger.UNKNOWN_PAGE_ID)}}});
