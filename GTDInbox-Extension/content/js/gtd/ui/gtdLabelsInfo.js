var gtdLabelsInfo=giUIObject.extend({_eventsContainer:null,el:null,connect:function(main){giLogger.log("st","gtdLabelsInfo.connect",main?main.pageId:giLogger.UNKNOWN_PAGE_ID);this.base(main);this._eventsContainer=new giEventsContainer(this);var doc=this._main.gmail.canvasDocument;this.el=doc.createElement("DIV");this.el.className="gtdi";var glSettingsView=this._main.gmail.getCurrentViewObject();var tabData=glSettingsView.getTab(glSettingsView.LABELS_TAB);tabData.elContent.appendChild(this.el);this.elContainer=
doc.createElement("DIV");this.el.appendChild(this.elContainer);this.elContainer.id="gtdi-gtd-labelsinfo-root";var me=this;giFileIO.readFile(null,"gtdLabels.htm",null,function(fileText){me._connect_postReadLabelsInfo(fileText)});this._eventsContainer.observe(this.el,"click",this._click,false)},_connect_postReadLabelsInfo:function(fileText){try{this.elContainer.innerHTML=fileText;var doc=this._main.gmail.canvasDocument;var elCategories=doc.getElementById("gtdi-gtd-labelsinfo-categories");var typeSettings=
this._main.prefs.getPref("labels.types");for(t in typeSettings)if(!typeSettings[t].isHidden){var elC=doc.createElement("DIV");elC.className="gtdi-gtd-labelsinfo-categories-container";elCategories.appendChild(elC);var elName=doc.createElement("P");elName.className="gtdi-gtd-labelsinfo-categories-name";elName.innerHTML=giI18N.getString("Labels.Types."+t);elC.appendChild(elName);var elPrefix=doc.createElement("P");elPrefix.className="gtdi-gtd-labelsinfo-categories-prefix";elPrefix.innerHTML=giI18N.getString("LabelsInfo.categories.prefix")+
" "+typeSettings[t].prefix;elC.appendChild(elPrefix);var info=giI18N.getString("LabelsInfo.desc."+t);if(info){var elInfo=doc.createElement("P");elInfo.className="gtdi-gtd-labelsinfo-categories-desc";elInfo.innerHTML=info;elC.appendChild(elInfo)}if(t=="statuses"){var sd=this._main.labelsData.getStatusData();var statuses=this._main.labelsData.getLabelsHash("statuses");if(!(statuses[sd["next_action"]]&&statuses[sd["waiting_on"]]&&statuses[sd["some_day"]])){var elButton=doc.createElement("DIV");elButton.id=
"gtdi-gtd-labelsinfo-setup";elButton.innerHTML=giI18N.getString("LabelsInfo.install");elC.appendChild(elButton)}}}}catch(e){giLogger.warn(e,"gtdLabelsInfo._connect_postReadLabelsInfo",null,this._main?this._main.pageId:giLogger.UNKNOWN_PAGE_ID)}},disconnect:function(){if(this.el&&this.el.parentNode)this.el.parentNode.removeChild(this.el);this.el=null;for(p in this)if(this[p]&&this[p].nodeName&&this[p].nodeType)this[p]=null;this._eventsContainer.reset();this._eventsContainer=null;this.base()},_click:function(evt){try{var el=
evt.target;if(el.id=="gtdi-gtd-labelsinfo-setup")this._main.getUIObject("setup");if(el.id=="gtdi-gtd-labelsinfo-preferences"){giUtil.stopEvent(evt);var a=window.open("chrome://gtdinbox/content/overlay_options.xul",null,"chrome,centerscreen");a.close();var a=window.open("chrome://gtdinbox/content/overlay_options.xul",null,"chrome,centerscreen")}}catch(e){giLogger.warn(e,"gtdLabelsInfo._click",null,this._main?this._main.pageId:giLogger.UNKNOWN_PAGE_ID)}}});
